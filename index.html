<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Justin Cheong - Portfolio</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500;700&display=swap" rel="stylesheet">

    <style>
        body { 
            margin: 0; 
            background-color: #cccccc; 
            overflow: hidden; 
            font-family: 'Oswald', sans-serif; 
        }
        
        /* --- HEADER & NAV --- */
        #header-name {
            position: absolute; top: 30px; left: 30px;
            color: #000000; font-size: 36px;
            font-weight: 700; letter-spacing: 2px; text-transform: uppercase;
            pointer-events: none; z-index: 100;
            text-shadow: 1px 1px 0 rgba(255,255,255,0.4); 
        }

        #nav-menu {
            position: absolute; top: 30px; right: 30px;
            display: flex; gap: 15px;
            z-index: 100;
        }

        .nav-btn {
            background: #000000; color: #ffffff;
            padding: 10px 20px; font-family: 'Oswald', sans-serif;
            font-weight: 700; font-size: 18px;
            cursor: pointer; border-radius: 6px;
            transition: all 0.2s; text-transform: uppercase;
            border: 2px solid transparent; 
        }
        
        .nav-btn:hover { transform: translateY(-2px); background: #222; }

        /* BUTTON GLOWS */
        #btn-battery { box-shadow: 0 0 15px rgba(0, 210, 255, 0.4); border-color: #00d2ff; }
        #btn-wire { box-shadow: 0 0 15px rgba(0, 255, 136, 0.4); border-color: #00ff88; }
        #btn-bulb { box-shadow: 0 0 15px rgba(255, 170, 0, 0.4); border-color: #ffaa00; }
        #btn-switch { box-shadow: 0 0 15px rgba(255, 102, 0, 0.4); border-color: #ff6600; }

        /* --- CONTROLS PANEL --- */
        #controls-key {
            display: none; 
            position: absolute; top: 90px; left: 30px;
            width: 300px;
            color: #fff; background: rgba(0, 0, 0, 0.85); 
            border: 1px solid #444; padding: 25px;
            border-radius: 12px; font-family: 'Oswald', sans-serif;
            font-size: 16px; z-index: 100; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            backdrop-filter: blur(8px);
            pointer-events: auto; 
            letter-spacing: 0.5px;
        }
        
        .controls-header {
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid #666; padding-bottom: 10px; margin-bottom: 15px;
        }

        .key-title { font-family: 'Oswald', sans-serif; font-size: 24px; color: #00d2ff; }
        
        .close-controls {
            cursor: pointer; font-weight: bold; font-size: 20px; color: #aaa; transition: color 0.2s;
        }
        .close-controls:hover { color: #fff; }

        .key-item { margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        .key-action { font-weight: 500; color: #ddd; }
        .key-bind { background: #333; color: #00d2ff; padding: 4px 8px; border-radius: 4px; font-size: 14px; font-weight: bold; font-family: monospace; }

        /* --- STATUS TAB --- */
        #status-tab {
            position: absolute; bottom: 30px; left: 30px;
            background: #000; border: 2px solid #ffaa00; 
            color: #ffaa00; padding: 12px 20px; border-radius: 6px;
            font-family: 'Oswald', sans-serif; font-size: 20px; font-weight: bold;
            z-index: 100; display: flex; align-items: center; gap: 12px;
            pointer-events: none; 
            box-shadow: 0 0 20px rgba(255, 170, 0, 0.2);
            letter-spacing: 1px;
        }
        
        .status-led {
            width: 12px; height: 12px; background: #ffaa00; border-radius: 50%;
            box-shadow: 0 0 10px #ffaa00;
            animation: pulse 1.5s infinite ease-in-out;
        }
        
        @keyframes pulse { 0% { opacity: 1; transform: scale(1); } 50% { opacity: 0.4; transform: scale(0.8); } 100% { opacity: 1; transform: scale(1); } }

        #bottom-controls {
            position: absolute; bottom: 30px; right: 30px;
            display: flex; gap: 10px; z-index: 100;
        }

        #reset-btn {
            background: #000; color: #00d2ff; 
            border: 2px solid #00d2ff; padding: 12px 24px; 
            font-size: 18px; font-weight: bold;
            cursor: pointer; border-radius: 6px;
            transition: all 0.2s; font-family: 'Oswald', sans-serif;
            letter-spacing: 1px;
        }
        #reset-btn:hover { background: #00d2ff; color: #000; box-shadow: 0 0 20px #00d2ff; }

        #loader {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: #000; font-family: 'Oswald', sans-serif; font-size: 48px; 
            pointer-events: none; text-shadow: 0px 0px 20px rgba(255, 255, 255, 0.8);
        }

        /* --- MINI POPUP --- */
        #mini-popup {
            display: none;
            position: absolute; bottom: 15%; left: 50%; transform: translateX(-50%);
            width: 420px; padding: 35px; 
            background: rgba(255, 255, 255, 0.95); 
            border-radius: 4px; 
            border-left: 8px solid #00d2ff; 
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            backdrop-filter: blur(15px); text-align: left; z-index: 10;
            transition: all 0.3s ease;
        }

        #mini-title { margin: 0 0 15px 0; color: #000; font-family: 'Oswald', sans-serif; font-size: 36px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; }
        
        #mini-desc { 
            font-size: 20px; 
            line-height: 1.5; margin-bottom: 25px; 
            color: #333; 
            font-family: 'Oswald', sans-serif; 
            font-weight: 400; 
        }

        #read-more-btn {
            display: block; width: 100%; padding: 14px 0;
            background: transparent; color: #000; 
            border: 3px solid #000; border-radius: 6px; 
            font-weight: 700; font-size: 18px;
            cursor: pointer; font-family: 'Oswald', sans-serif;
            text-transform: uppercase; letter-spacing: 1px;
            transition: all 0.2s ease;
        }
        #read-more-btn:hover { background: #000; color: #fff; transform: scale(1.02); }

        .close-mini {
            position: absolute; top: 15px; right: 20px;
            font-family: 'Oswald', sans-serif; font-weight: bold; font-size: 28px;
            cursor: pointer; color: #bbb; transition: color 0.2s;
        }
        .close-mini:hover { color: #000; }

        /* --- FULL MODAL --- */
        #modal-overlay {
            display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.9); z-index: 1000; justify-content: center; align-items: center;
        }

        #modal-card { display: flex; width: 100%; height: 100%; background: #111; position: relative; }
        #modal-3d { flex: 10; background: #e0e0e0; position: relative; border-right: 5px solid #000; }
        
        #modal-info { 
            flex: 11; padding: 80px; 
            background: #111; /* Dark Background */
            color: #fff; /* White Text */
            overflow-y: auto; display: flex; flex-direction: column; justify-content: flex-start; 
        }

        /* DEFAULT TOP IMAGE */
        #modal-project-img {
            width: 100%; max-height: 350px; object-fit: cover;
            border-radius: 12px; margin-bottom: 25px; display: none; 
            border: 4px solid #fff; box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: box-shadow 0.3s ease;
        }

        /* --- PROJECT IMAGE STYLING --- */
        .project-img {
            width: 100%; height: auto; object-fit: contain; border-radius: 8px; margin: 20px 0; 
            border: 3px solid #fff; display: block;
        }
        
        /* --- PLACEHOLDER FOR MISSING IMAGES --- */
        .project-img-placeholder {
            width: 100%; height: 250px; background: #000;
            border: 3px dashed #ffaa00; border-radius: 8px;
            display: flex; justify-content: center; align-items: center;
            margin: 20px 0; color: #ffaa00; font-family: 'Oswald', sans-serif;
            font-size: 32px; letter-spacing: 2px;
            box-shadow: 0 0 20px rgba(255, 170, 0, 0.2);
        }
        
        .glow-yellow { box-shadow: 0 0 30px rgba(255, 170, 0, 0.5); border-color: #ffaa00; }

        h2 { 
            margin-top: 0; color: #fff;
            font-size: 56px; 
            font-family: 'Oswald', sans-serif; text-transform: uppercase; 
            margin-bottom: 25px; border-bottom: 6px solid #00d2ff; 
            padding-bottom: 15px; line-height: 1; font-weight: 700;
        }
        
        /* CONTENT STYLING */
        .content-body { 
            color: #ddd; /* Light Grey Text */
            line-height: 1.6; 
            font-size: 20px; 
            font-family: 'Oswald', sans-serif;
            font-weight: 300;
            letter-spacing: 0.5px;
        }
        
        p {
            color: #ddd; /* Light Grey Text */
            line-height: 1.6;
            font-size: 20px;
            white-space: pre-wrap;
            font-family: 'Oswald', sans-serif;
            font-weight: 400;
            letter-spacing: 0.5px;
        }

        h3 { font-family: 'Oswald', sans-serif; font-size: 32px; color: #fff; margin-top: 10px; margin-bottom: 10px; line-height: 1; font-weight: 600; }
        .project-divider { border: 0; border-top: 2px solid #444; margin: 50px 0; }
        
        /* --- ABOUT ME & SKILLS STYLING --- */
        .about-role { font-family: 'Oswald', sans-serif; font-size: 26px; color: #00d2ff; letter-spacing: 1px; margin-bottom: 5px; font-weight: 600; }
        
        .about-school { 
            font-family: 'Oswald', sans-serif;
            font-size: 20px; 
            font-weight: 500; 
            color: #aaa; /* Lighter Grey */
            margin-bottom: 20px; 
            letter-spacing: 1px;
        }

        /* The Grid for Stats */
        .specs-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 25px 0; }
        
        .spec-item { 
            border: 2px solid #fff; /* White border */
            border-radius: 6px; padding: 10px; text-align: center; transition: transform 0.2s; 
        }
        .spec-item:hover { transform: translateY(-3px); border-color: #00d2ff; box-shadow: 0 5px 15px rgba(0, 210, 255, 0.2); }
        
        .spec-label { 
            display: block; 
            font-size: 12px; 
            font-weight: bold; 
            color: #888; 
            letter-spacing: 1px; 
            margin-bottom: 4px;
            font-family: 'Oswald', sans-serif;
        }
        
        .spec-value { display: block; font-family: 'Oswald', sans-serif; font-size: 22px; color: #fff; line-height: 1; font-weight: 600; }

        /* Skill Categories */
        .skill-category-label { 
            font-size: 16px; font-family: 'Oswald', sans-serif; font-weight: 700; 
            color: #fff; text-transform: uppercase; margin: 15px 0 8px 0; 
            border-left: 4px solid #00d2ff; padding-left: 10px; letter-spacing: 1px; 
        }
        
        /* SKILLS CONTAINER */
        .skills-container { 
            margin-top: 15px; 
            background: #e8e8e8; 
            padding: 20px; 
            border-radius: 8px; 
            border-left: 5px solid #000; 
        }
        
        .skills-title { font-family: 'Oswald', sans-serif; font-size: 22px; font-weight: 600; margin-bottom: 10px; color: #000; text-transform: uppercase; }
        .skills-list { display: flex; flex-wrap: wrap; gap: 10px; list-style: none; padding: 0; margin: 0; }
        
        .skill-tag { 
            background: #000; color: #fff; padding: 5px 12px; border-radius: 20px; 
            font-size: 16px; 
            font-family: 'Oswald', sans-serif;
            font-weight: 400; 
            letter-spacing: 0.5px;
        }

        /* --- EXPERIENCE & EDUCATION BOX STYLING --- */
        .resume-header {
            font-size: 30px;
            font-weight: 700;
            color: #fff;
            margin-top: 30px;
            margin-bottom: 15px;
            text-transform: uppercase;
            border-bottom: 1px solid #444;
            padding-bottom: 5px;
        }
        
        .resume-item { margin-bottom: 20px; }

        .resume-job-title { font-size: 22px; font-weight: 500; color: #ddd; margin-bottom: 8px; }

        .resume-detail-box {
            background: rgba(255, 255, 255, 0.05); 
            border-left: 4px solid #fff; 
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 0 4px 4px 0;
            font-size: 18px;
            color: #ccc;
        }

        #close-btn {
            position: absolute; top: 30px; right: 40px;
            background: none; border: none; color: #fff; 
            cursor: pointer; font-size: 60px; line-height: 1; z-index: 200;
            font-family: 'Oswald', sans-serif;
        }
        #close-btn:hover { color: #00d2ff; }

        /* --- UPDATED TUTORIAL OVERLAY (Smaller) --- */
        .overlay-screen {
            display: flex; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(10, 10, 10, 0.95); backdrop-filter: blur(10px);
            z-index: 2000; justify-content: center; align-items: center;
            color: #fff; flex-direction: column; text-align: center;
        }

        .tutorial-content { 
            max-width: 550px; /* Reduced width */
            padding: 30px;    /* Reduced padding */
            border: 2px solid #00d2ff; border-radius: 20px; 
            background: rgba(0,0,0,0.6); box-shadow: 0 0 60px rgba(0, 210, 255, 0.15); 
        }
        .tutorial-title { 
            font-size: 48px; /* Smaller Title */
            font-family: 'Oswald', sans-serif; margin-bottom: 15px; color: #fff; text-shadow: 0 0 20px #00d2ff; font-weight: 700; 
        }
        .tutorial-text { 
            font-size: 20px; /* Smaller Text */
            line-height: 1.4; margin-bottom: 30px; color: #ddd; font-family: 'Oswald', sans-serif; font-weight: 300; 
        }
        
        .step-list { text-align: left; display: inline-block; margin: 0 auto 40px auto; }
        .step-item { margin-bottom: 15px; font-size: 18px; display: flex; align-items: center; font-family: 'Oswald', sans-serif; }
        .step-num { 
            display: inline-block; width: 35px; height: 35px; border: 2px solid #00d2ff; border-radius: 50%; 
            text-align: center; line-height: 30px; margin-right: 15px; 
            font-weight: bold; flex-shrink: 0; color: #00d2ff; font-family: 'Oswald', sans-serif; font-size: 20px;
        }
        
        .action-btn {
            background: #fff; color: #000; border: none; padding: 12px 40px; font-size: 24px; font-weight: bold;
            cursor: pointer; border-radius: 8px; box-shadow: 0 0 30px rgba(0, 210, 255, 0.4);
            font-family: 'Oswald', sans-serif; text-transform: uppercase; transition: all 0.2s;
        }
        .action-btn:hover { transform: scale(1.05); background: #00d2ff; color: #fff; }
        .tutorial-hint { margin-top: 20px; color: #888; font-size: 14px; font-family: 'Oswald', sans-serif; }

        .collision-flash { animation: flashRed 0.2s ease-out; }
        @keyframes flashRed { 0% { box-shadow: inset 0 0 100px red; } 100% { box-shadow: none; } }
    </style>

    <script>
        const audio = new Audio("No_SFX-2023-05-02_-_Galaxys_Endless_Expanse_-_www.FesliyanStudios.com.mp3");
        audio.loop = true; audio.volume = 0.15; 

        const clickSound = new Audio("immersivecontrol-button-click-sound-463065.mp3");
        clickSound.volume = 1.0; 

        const impactSound = new Audio("thud-impact-sound-sfx-379990.mp3");

        function toggleOverlay(id) {
            const el = document.getElementById(id);
            if (el) {
                el.style.display = (el.style.display === 'none' || el.style.display === '') ? 'flex' : 'none';
            }
        }

        function playClickSound() {
            clickSound.currentTime = 0; clickSound.play().catch(e => {});
        }

        function startAudio() {
            audio.play().catch(e => {});
            document.removeEventListener('click', startAudio);
        }

        document.addEventListener('click', (event) => {
            if (event.target.closest('button') || event.target.classList.contains('nav-btn') || 
                event.target.classList.contains('action-btn') || event.target.classList.contains('close-controls') || 
                event.target.classList.contains('close-mini')) {
                playClickSound();
            }
            startAudio(); 
        });
    </script>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
</head>
<body id="mainBody">

    <div id="tutorial-overlay" class="overlay-screen">
        <div class="tutorial-content">
            <div class="tutorial-title">Welcome to My Circuit Portfolio!</div>
            <div class="tutorial-text">
                I'm Justin Cheong, and this is my interactive circuit board.
                Here's a quick guide to get you started:
            </div>
            <div class="step-list">
                <div class="step-item"><div class="step-num">1</div> <div>Explore the circuit by dragging (Left Click) and panning (Right Click).</div></div>
                <div class="step-item"><div class="step-num">2</div> <div>Click on any component (or use the top navigation) to learn more about it.</div></div>
                <div class="step-item"><div class="step-num">3</div> <div>Press <b>'C'</b> at any time to reset the camera to this view.</div></div>
                <div class="step-item"><div class="step-num">4</div> <div>If you're curious, try pressing <b>'R'</b> to toggle the secret rocket!</div></div>
            </div>
            <button class="action-btn" onclick="toggleOverlay('tutorial-overlay')">Begin Exploration</button>
            <div class="tutorial-hint">You can press 'T' at any time to see this tutorial again.</div>
        </div>
    </div>

    <div id="header-name">JUSTIN CHEONG</div>
    
    <div id="nav-menu">
        <button id="btn-battery" class="nav-btn" onclick="triggerNav('battery')">About Me</button>
        <button id="btn-wire" class="nav-btn" onclick="triggerNav('wire')">Experience</button>
        <button id="btn-bulb" class="nav-btn" onclick="triggerNav('bulb')">Projects</button>
        <button id="btn-switch" class="nav-btn" onclick="triggerNav('switch')">Achievements</button>
    </div>

    <div id="controls-key">
        <div class="controls-header">
            <div class="key-title">Controls</div>
            <div class="close-controls" onclick="document.getElementById('controls-key').style.display='none'">X</div>
        </div>
        <div class="key-item"><span class="key-action">Drag:</span> <span class="key-bind">Left-Click</span></div>
        <div class="key-item"><span class="key-action">Pan:</span> <span class="key-bind">Right-Click</span></div>
        <div class="key-item"><span class="key-action">Zoom:</span> <span class="key-bind">Scroll</span></div>
        <div class="key-item"><span class="key-action">Reset View:</span> <span class="key-bind">'C'</span></div>
        <div class="key-item"><span class="key-action">Toggle Rocket:</span> <span class="key-bind">'R'</span></div>
        <div class="key-item"><span class="key-action">Tutorial:</span> <span class="key-bind">'T'</span></div>
        <div class="key-item"><span class="key-action">Toggle Help:</span> <span class="key-bind">'H'</span></div>
        <hr style="border: 0; border-top: 1px solid #666; margin: 15px 0;">
        <div class="key-item"><span class="key-action">Rocket Move:</span> <span class="key-bind">WASD</span></div>
        <div class="key-item"><span class="key-action">Rocket Lift:</span> <span class="key-bind">Q / E</span></div>
    </div>

    <div id="status-tab">
        <div class="status-led"></div>
        <span>WORK IN PROGRESS</span>
    </div>

    <div id="bottom-controls">
        <button id="reset-btn" onclick="resetCameraView()">RESET CAMERA [C]</button>
    </div>

    <div id="loader">Loading...</div>

    <div id="mini-popup">
        <div class="close-mini" onclick="document.getElementById('mini-popup').style.display='none'">X</div>
        <h3 id="mini-title">Title</h3>
        <div id="mini-desc">Short description...</div>
        <button id="read-more-btn">READ MORE</button>
    </div>

    <div id="modal-overlay">
        <div id="modal-card">
            <button id="close-btn" onclick="document.getElementById('modal-overlay').style.display='none'">×</button>
            <div id="modal-3d"></div>
            <div id="modal-info">
                <h2 id="popup-title">Title</h2>
                <img id="modal-project-img" src="" alt="Project Image">
                <div id="popup-content" class="content-body">Content</div>
            </div>
        </div>
    </div>

    <script type="module">
        import * as THREE from 'three';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        // --- DATA CONTENT ---
        const contentAbout = { 
            title: "About Me", 
            mini: "Powering the System.", 
            color: "#00d2ff", 
            text: `
                <div class="about-role">ELECTRICAL ENGINEERING STUDENT</div>
                <div class="about-school">Boston University</div>
                
                <p>Hello! I'm Justin Cheong. My expertise lies in bridging the gap between hardware and software, designing systems that integrate complex logic with physical components.</p>
                
                <div class="specs-grid">
                    <div class="spec-item">
                        <span class="spec-label">GPA</span>
                        <span class="spec-value">3.89</span>
                    </div>
                    <div class="spec-item">
                        <span class="spec-label">CLASS OF</span>
                        <span class="spec-value">2027</span>
                    </div>
                    <div class="spec-item">
                        <span class="spec-label">LOCATION</span>
                        <span class="spec-value">Boston</span>
                    </div>
                </div>

                <hr class="project-divider">

                <h3>Technical Arsenal</h3>
                
                <div class="skill-category-label">PROGRAMMING & SOFTWARE</div>
                <ul class="skills-list">
                    <li class="skill-tag">C++</li>
                    <li class="skill-tag">Python</li>
                    <li class="skill-tag">Java</li>
                    <li class="skill-tag">MATLAB</li>
                    <li class="skill-tag">Verilog</li>
                    <li class="skill-tag">Android Studio</li>
                </ul>

                <div class="skill-category-label">HARDWARE & TOOLS</div>
                <ul class="skills-list">
                    <li class="skill-tag">Arduino</li>
                    <li class="skill-tag">FPGA (Vivado)</li>
                    <li class="skill-tag">Oscilloscopes</li>
                    <li class="skill-tag">Git / Linux</li>
                    <li class="skill-tag">Circuit Design</li>
                </ul>
            `
        };

        const contentExperience = { 
            title: "Experience & Education", 
            mini: "Connecting the dots.",    
            color: "#00ff88", 
            text: `
                <div class="resume-header">Education</div>
                
                <div class="resume-item">
                    <div class="resume-job-title">Boston University College of Engineering</div>
                    <div class="resume-detail-box">B.S. in Electrical Engineering (Expected May 2027)</div>
                    <div class="resume-detail-box">Dean's List Recipient (4 Semesters)</div>
                    <div class="resume-detail-box">Relevant Coursework: Linear Algebra, Multivariable Calculus, Deep Learning, Advanced Data Structures and Algorithms</div>
                </div>

                <div class="resume-header">Experience</div>

                <div class="resume-item">
                    <div class="resume-job-title">Powdher Construction Management (May 2025 – Aug 2025)</div>
                    <div class="resume-detail-box">Assisted in reviewing electrical blueprints for residential and commercial projects (lighting, power, low-voltage).</div>
                    <div class="resume-detail-box">Conducted on-site walkthroughs to verify field conditions against engineering plans.</div>
                </div>
            `
        };
        
        // --- UPDATED ACHIEVEMENTS (Formatted) ---
        const contentAchievements = { 
            title: "Achievements",  
            mini: "Making the switch.",    
            color: "#ff6600", 
            text: `
                <div class="resume-header">Honors & Awards</div>

                <div class="resume-item">
                    <div class="resume-job-title">Boston University</div>
                    <div class="resume-detail-box">Dean's List Recipient (4 Semesters: Spring 2024 - Fall 2025)</div>
                    <div class="resume-detail-box">High Academic Standing: Maintained a 3.89 GPA while managing intensive engineering coursework.</div>
                </div>

                <div class="resume-header">Competitions</div>

                <div class="resume-item">
                    <div class="resume-job-title">HackHardware x RASTIC</div>
                    <div class="resume-detail-box">Competitor: Designed and built a competitive autonomous robot (3rd Place).</div>
                </div>
            `
        };
        
        // --- PROJECT DATA ---
        const contentProjects = { 
            title: "Projects", 
            mini: "Bright Ideas.",          
            color: "#ffaa00",
            text: `
                <h3>Smart Glasses HUD</h3>
                <div class="project-img-placeholder glow-yellow">
                    <span>IMAGE IN PROGRESS</span>
                </div>
                <p>Designed and assembled a wearable optical system using a beam-splitter and semi-reflective combiner glass to overlay digital notifications onto a transparent lens.</p>
                <p>Engineered an integrated hardware platform using an Arduino microcontroller to drive micro-OLED displays.</p>
                <div class="skills-container">
                    <div class="skills-title">Skills Used</div>
                    <ul class="skills-list">
                        <li class="skill-tag">Arduino</li>
                        <li class="skill-tag">C++</li>
                        <li class="skill-tag">Optics & Physics</li>
                        <li class="skill-tag">Hardware Prototyping</li>
                        <li class="skill-tag">Circuit Design</li>
                    </ul>
                </div>

                <hr class="project-divider">

                <h3>Interactive 3D Portfolio</h3>
                <img src="portfolio_photos/portfolio.png" class="project-img glow-yellow" alt="Portfolio Website">
                <p>Designed and developed an immersive 3D portfolio website to showcase engineering projects. Built a custom interactive scene using Three.js, featuring a navigable circuit board environment with animated textures and dynamic camera controls.</p>
                <div class="skills-container">
                    <div class="skills-title">Skills Used</div>
                    <ul class="skills-list">
                        <li class="skill-tag">JavaScript (ES6+)</li>
                        <li class="skill-tag">Three.js</li>
                        <li class="skill-tag">WebGL</li>
                        <li class="skill-tag">HTML5 & CSS3</li>
                        <li class="skill-tag">3D Asset Integration</li>
                    </ul>
                </div>

                <hr class="project-divider">

                <h3>Coin-Collecting Robot (HackHardware)</h3>
                <img src="portfolio_photos/rover.png" class="project-img glow-yellow" alt="Robot">
                <p>Engineered a servo-controlled robotic arm outfitted with a magnet mechanism to pick up and deposit metallic coins into point-scoring bins (Gold, Silver, Bronze).</p>
                <div class="skills-container">
                    <div class="skills-title">Skills Used</div>
                    <ul class="skills-list">
                        <li class="skill-tag">C++</li>
                        <li class="skill-tag">Arduino</li>
                        <li class="skill-tag">Servo & DC Motors</li>
                        <li class="skill-tag">Electromagnetism</li>
                        <li class="skill-tag">SolidWorks (CAD)</li>
                    </ul>
                </div>

                <hr class="project-divider">

                <h3>Tetris-inspired Game (Android)</h3>
                <img src="portfolio_photos/TetrTriDiMonoTris.png" class="project-img glow-yellow" alt="Tetris Game">
                <p>Developed a full-featured Android game app. Created custom XML layouts for the game grid and UI controls. Integrated background audio services and touch-based control logic in Java.</p>
                <div class="skills-container">
                    <div class="skills-title">Skills Used</div>
                    <ul class="skills-list">
                        <li class="skill-tag">Java</li>
                        <li class="skill-tag">Android Studio</li>
                        <li class="skill-tag">XML Layouts</li>
                        <li class="skill-tag">GitLab (Version Control)</li>
                        <li class="skill-tag">Object-Oriented Programming</li>
                    </ul>
                </div>

                <hr class="project-divider">

                <h3>Whack-A-Mole (FPGA)</h3>
                <img src="portfolio_photos/whack_a_mole.png" class="project-img glow-yellow" alt="Whack-A-Mole FPGA">
                <p>Implemented a complete game on an FPGA board using Verilog. Designed complex digital logic state machines to control onboard LEDs acting as "moles," handle asynchronous user button inputs, and manage scoring and timing.</p>
                <div class="skills-container">
                    <div class="skills-title">Skills Used</div>
                    <ul class="skills-list">
                        <li class="skill-tag">Verilog</li>
                        <li class="skill-tag">FPGA Design</li>
                        <li class="skill-tag">Digital Logic</li>
                        <li class="skill-tag">Finite State Machines</li>
                        <li class="skill-tag">ModelSim</li>
                    </ul>
                </div>

                <hr class="project-divider">

                <h3>Other Projects</h3>
                <p><strong>Acoustic Heart Rate Monitor:</strong> Built an op-amp circuit to amplify heart sounds.</p>
            `
        };

        const myPortfolio = {
            "battery":      { ...contentAbout, target: "battery", popupScale: 7.8, viewDist: 2.5 }, 
            "wire":         { ...contentExperience, target: "wire", popupScale: 4.0, viewDist: 2.0 },
            "bulb":         { ...contentProjects, target: "bulb", popupScale: 6.0, viewDist: 2.0 },
            "switch":       { ...contentAchievements, target: "switch", popupScale: 7.8, viewDist: 2.5 } 
        };

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0xcccccc); 
        const camera = new THREE.PerspectiveCamera( 30, window.innerWidth / window.innerHeight, 0.01, 5000 );
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize( window.innerWidth, window.innerHeight );
        renderer.outputColorSpace = THREE.SRGBColorSpace; 
        document.body.appendChild( renderer.domElement );

        // --- POPUP SCENE ---
        const popupScene = new THREE.Scene();
        popupScene.background = new THREE.Color(0xe0e0e0); 
        const popupCamera = new THREE.PerspectiveCamera( 45, 1, 0.1, 100 );
        popupCamera.position.set(2, 2, 4); 
        const pAmbient = new THREE.AmbientLight(0xffffff, 0.8); popupScene.add(pAmbient);
        const pCamLight = new THREE.DirectionalLight(0xffffff, 1.5); pCamLight.position.set(2, 5, 5); popupScene.add(pCamLight);
        const popupRenderer = new THREE.WebGLRenderer({ antialias: true });
        document.getElementById('modal-3d').appendChild(popupRenderer.domElement);
        const popupControls = new OrbitControls(popupCamera, popupRenderer.domElement);
        popupControls.enableDamping = true; popupControls.autoRotate = true; 

        const loader = new GLTFLoader();
        scene.add( new THREE.AmbientLight( 0xffffff, 0.7 ) );
        const camLight = new THREE.DirectionalLight(0xffffff, 1.5); camLight.position.set(0, 0, 1); camera.add(camLight); scene.add(camera);
        const dirLight = new THREE.DirectionalLight( 0xffffff, 2.0 ); dirLight.position.set( 5, 10, 7.5 ); scene.add( dirLight );

        const controls = new OrbitControls( camera, renderer.domElement );
        controls.enableDamping = true; controls.enablePan = true; controls.enableZoom = true;
        
        // --- ANIMATED TEXTURE GENERATOR ---
        function createFlowTexture() {
            const canvas = document.createElement('canvas');
            canvas.width = 64; canvas.height = 64;
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = '#000000'; ctx.fillRect(0,0,64,64);
            ctx.fillStyle = '#ffffff'; ctx.fillRect(0, 0, 64, 32); 
            const tex = new THREE.CanvasTexture(canvas);
            tex.wrapS = THREE.RepeatWrapping; tex.wrapT = THREE.RepeatWrapping;
            tex.repeat.set(4, 1); return tex;
        }
        
        let wireTexture = null;
        let rocketContainer = null, rocketModel = null;
        const velocity = new THREE.Vector3(0, 0, 0);
        const acceleration = 0.01, friction = 0.93, maxSpeed = 0.15;      
        let collisionActive = false;

        const rocketHitbox = new THREE.Box3();
        const obstacleSphere = new THREE.Sphere();
        const hitboxVisualSize = new THREE.Vector3(0.5, 0.5, 1.8);
        const hitboxOffset = new THREE.Vector3(0, -4.95, -1.6);
        const manualObstacles = [
            { name: "Battery", pos: new THREE.Vector3(-1.73, -0.32, -2.67), radius: 0.6 },
            { name: "Bulb Glass", pos: new THREE.Vector3(1.21, 0.97, -2.74), radius: 0.6 },
            { name: "Bulb Base", pos: new THREE.Vector3(1.25, 0.07, -2.76), radius: 0.3 },
            { name: "Switch", pos: new THREE.Vector3(0.07, -0.25, -0.50), radius: 0.6 }
        ];

        let explosion = null; const explosionMaxSize = 2.5;
        const keyState = {}; 
        window.addEventListener('keydown', (e) => { 
            keyState[e.code] = true; 
            if(e.code === 'KeyR') toggleRocket(); 
            if(e.code === 'KeyC') resetCameraView();
            if(e.code === 'KeyT') toggleOverlay('tutorial-overlay'); 
            if(e.code === 'KeyH') toggleOverlay('controls-key'); 
            if(e.code === 'Escape') document.getElementById('modal-overlay').style.display = 'none';
        });
        window.addEventListener('keyup', (e) => { keyState[e.code] = false; });

        function toggleRocket() {
            if (rocketContainer) { scene.remove(rocketContainer); rocketContainer = null; velocity.set(0,0,0); } 
            else { spawnRocket(); }
        }

        function createExplosion(pos) {
            const geo = new THREE.SphereGeometry(1, 32, 32);
            const mat = new THREE.MeshBasicMaterial({ color: 0xffff00, transparent: true, opacity: 1.0 });
            explosion = new THREE.Mesh(geo, mat);
            explosion.position.copy(pos); explosion.scale.set(0.1, 0.1, 0.1);
            scene.add(explosion);
        }

        function spawnRocket() {
            // UPDATED: PATH SET TO ROOT
            loader.load( './rocket.glb', function ( gltf ) {
                rocketModel = gltf.scene; rocketModel.updateMatrixWorld(true);
                const box = new THREE.Box3().setFromObject(rocketModel);
                const center = box.getCenter(new THREE.Vector3()); const size = box.getSize(new THREE.Vector3());
                rocketModel.position.x -= center.x; rocketModel.position.y -= center.y; rocketModel.position.z -= center.z;
                rocketModel.traverse((child) => { if (child.isMesh) { child.material = new THREE.MeshStandardMaterial({ color: child.material.color, map: child.material.map || null, metalness: 0.1, roughness: 0.6, side: THREE.DoubleSide }); } });
                rocketContainer = new THREE.Group(); rocketContainer.add(rocketModel);
                const maxDim = Math.max(size.x, size.y, size.z);
                if (maxDim > 0) { const scaleFactor = 2.0 / maxDim; rocketModel.scale.set(scaleFactor, scaleFactor, scaleFactor); }
                rocketModel.rotation.x = -Math.PI / 2; rocketContainer.position.set(1, 6.0, 1); 
                scene.add(rocketContainer);
            }, undefined, function(e){ console.error(e); });
        }

        let loadedModel, introActive = true, zoomActive = false; 
        let targetPosition = new THREE.Vector3(), targetLookAt = new THREE.Vector3();
        let currentSelection = null; let currentObject = null;   

        window.resetCameraView = function() {
            if(!loadedModel) return;
            introActive = true; zoomActive = false; controls.autoRotate = true; 
            controls.target.set(0, 0.5, 0);
            document.getElementById('modal-overlay').style.display = 'none';
            document.getElementById('mini-popup').style.display = 'none';
            const fov = camera.fov * ( Math.PI / 180 );
            let cameraZ = Math.abs( 5.0 / 2 * Math.tan( fov * 2 ) ); 
            targetPosition.set( cameraZ * 0.5, (cameraZ * 0.5) + 0.5, cameraZ * 2.0 );
            camera.position.copy(targetPosition).multiplyScalar(4); 
            controls.update();
        };
        
        renderer.domElement.addEventListener('pointerdown', () => {
            introActive = false; zoomActive = false; controls.autoRotate = false;
        });

        // --- LOAD MODEL (model.glb) + ANIMATED TEXTURE ---
        loader.load( './model.glb', function ( gltf ) {
            loadedModel = gltf.scene; scene.add( loadedModel );
            document.getElementById('loader').style.display = 'none';
            
            wireTexture = createFlowTexture();

            loadedModel.traverse((child) => {
                if (child.isMesh) {
                    const n = child.name.toLowerCase();
                    if (n.includes('wire') && !n.includes('word') && !n.includes('text')) {
                        child.material = new THREE.MeshStandardMaterial({
                            color: 0x333333,       
                            emissive: 0x00ff88,    
                            emissiveMap: wireTexture,
                            emissiveIntensity: 2.0
                        });
                    }
                }
            });

            const box = new THREE.Box3().setFromObject( loadedModel );
            const center = box.getCenter( new THREE.Vector3() ); const size = box.getSize( new THREE.Vector3() );
            loadedModel.position.x += (loadedModel.position.x - center.x) - 1.1;
            loadedModel.position.y += (loadedModel.position.y - center.y) - 4.5; 
            loadedModel.position.z += (loadedModel.position.z - center.z);
            loadedModel.scale.setScalar(5.0 / Math.max( size.x, size.y, size.z ));
            resetCameraView();
        }, undefined, function(e){ console.error(e); alert("Error loading model!"); });

        function handleObjectSelection(targetName, objectToFocus) {
            let match = null; const lowerName = targetName.toLowerCase();
            for (const key in myPortfolio) { if (lowerName.includes(key.toLowerCase())) { match = myPortfolio[key]; break; } }
            if (!match) return; 
            currentSelection = match;
            let finalObject = null;
            if (objectToFocus) {
                const n = objectToFocus.name.toLowerCase();
                if (!n.includes('word') && !n.includes('text') && !n.includes('font')) { finalObject = objectToFocus; }
            }
            if (!finalObject && loadedModel) {
                loadedModel.traverse((child) => {
                    if (child.name) {
                        const n = child.name.toLowerCase();
                        if (n.includes(match.target) && !n.includes('word') && !n.includes('text') && !n.includes('font')) { finalObject = child; }
                    }
                });
            }
            if (!finalObject) return;
            currentObject = finalObject; 
            const box = new THREE.Box3().setFromObject(finalObject);
            const center = box.getCenter(new THREE.Vector3()); const size = box.getSize(new THREE.Vector3());
            targetLookAt.copy(center); 
            const dist = Math.max(size.x, size.y, size.z) * (match.viewDist || 2.0); 
            targetPosition.copy(center).add(new THREE.Vector3(0, 1, 1).normalize().multiplyScalar(dist));
            introActive = false; zoomActive = true; controls.autoRotate = false;
            
            const miniPopup = document.getElementById('mini-popup');
            document.getElementById('mini-title').innerText = match.title;
            document.getElementById('mini-desc').innerText = match.mini;
            if (match.color) {
                miniPopup.style.borderLeftColor = match.color;
                miniPopup.style.boxShadow = `0 20px 50px ${match.color}50`;
            }
            miniPopup.style.display = 'block';
        }

        window.triggerNav = (key) => { handleObjectSelection(key, null); }

        document.getElementById('read-more-btn').addEventListener('click', function() {
            if(!currentSelection) return;
            document.getElementById('mini-popup').style.display = 'none';
            const modal = document.getElementById('modal-overlay');
            modal.style.display = 'flex'; 
            document.getElementById('popup-title').innerText = currentSelection.title;
            
            // --- INJECT HTML CONTENT ---
            document.getElementById('popup-content').innerHTML = currentSelection.text;
            
            // COLOR THE SKILLS BORDER DYNAMICALLY
            const skillsDivs = document.querySelectorAll('.skills-container');
            skillsDivs.forEach(div => {
                if(currentSelection.color) {
                    div.style.borderLeftColor = currentSelection.color;
                }
            });
            
            // COLOR THE ABOUT ME CATEGORIES DYNAMICALLY
            const categoryLabels = document.querySelectorAll('.skill-category-label');
            categoryLabels.forEach(label => {
                if(currentSelection.color) {
                    label.style.borderLeftColor = currentSelection.color;
                }
            });

            // COLOR THE EXPERIENCE BOX BORDERS DYNAMICALLY
            const detailBoxes = document.querySelectorAll('.resume-detail-box');
            detailBoxes.forEach(box => {
                if(currentSelection.color) {
                    box.style.borderLeftColor = currentSelection.color;
                }
            });

            // UPDATE HEADER UNDERLINE COLOR
            document.querySelector('h2').style.borderBottomColor = currentSelection.color || '#00d2ff';

            // Hide the default top image if using internal images
            const imgEl = document.getElementById('modal-project-img');
            if (currentSelection.img) { 
                // Only show top image if NOT using the text-based layout with internal images
                if(!currentSelection.text.includes('<img') && !currentSelection.text.includes('project-img-placeholder')) {
                    imgEl.src = currentSelection.img; 
                    imgEl.style.display = 'block'; 
                    if(currentSelection.color) imgEl.style.boxShadow = `0 10px 40px ${currentSelection.color}60`;
                    imgEl.style.borderColor = "#fff"; // Ensure border is white in dark mode
                } else {
                    imgEl.style.display = 'none'; // Hide top image if images are in text
                }
            } else { 
                imgEl.style.display = 'none'; 
                imgEl.src = ""; 
            }

            if(currentObject) {
                while(popupScene.children.length > 2) { popupScene.remove(popupScene.children[2]); }
                const clone = currentObject.clone();
                clone.position.set(0, 0, 0); clone.rotation.set(0, 0, 0);
                const scaleFactor = currentSelection.popupScale || 1.0;
                clone.scale.multiplyScalar(scaleFactor);
                const box = new THREE.Box3().setFromObject(clone);
                const center = box.getCenter(new THREE.Vector3());
                clone.position.sub(center); 
                popupScene.add(clone);
                popupControls.reset(); popupControls.target.set(0,0,0);
            }
            setTimeout(() => {
                const container = document.getElementById('modal-3d');
                popupRenderer.setSize(container.clientWidth, container.clientHeight);
                popupCamera.aspect = container.clientWidth / container.clientHeight;
                popupCamera.updateProjectionMatrix();
            }, 50);
        });

        window.addEventListener( 'click', (event) => {
            if (event.target.closest('#modal-card') || event.target.closest('#mini-popup') || event.target.closest('.action-btn') || event.target.closest('#controls-key') || event.target.closest('#nav-menu') || event.target.closest('button')) return;
            document.getElementById('mini-popup').style.display = 'none';
            zoomActive = false;
            const mouse = new THREE.Vector2(( event.clientX / window.innerWidth ) * 2 - 1, -( event.clientY / window.innerHeight ) * 2 + 1);
            const raycaster = new THREE.Raycaster(); raycaster.setFromCamera( mouse, camera );
            if(loadedModel) {
                const hits = raycaster.intersectObjects( loadedModel.children, true );
                if ( hits.length > 0 ) {
                    let o = hits[0].object;
                    while(o.parent && (o.name === "" || o.name.includes("Object_"))) o = o.parent;
                    handleObjectSelection(o.name, o);
                }
            }
        });

        function animate() {
            requestAnimationFrame( animate );
            if (wireTexture) { wireTexture.offset.x -= 0.01; } 

            if (explosion) {
                explosion.scale.addScalar(0.15);
                explosion.material.opacity -= 0.04;
                if (explosion.scale.x > explosionMaxSize || explosion.material.opacity <= 0) {
                    scene.remove(explosion);
                    explosion = null;
                }
            }
            if (rocketContainer) {
                if (keyState['KeyW']) velocity.z -= acceleration;
                if (keyState['KeyS']) velocity.z += acceleration;
                if (keyState['KeyA']) velocity.x -= acceleration;
                if (keyState['KeyD']) velocity.x += acceleration;
                if (keyState['KeyQ']) velocity.y += acceleration;
                if (keyState['KeyE']) velocity.y -= acceleration;
                velocity.multiplyScalar(friction); velocity.clampLength(0, maxSpeed); 
                if (Math.abs(velocity.x) > 0.001 || Math.abs(velocity.z) > 0.001) {
                    const angle = Math.atan2(velocity.x, velocity.z) + Math.PI;
                    let delta = angle - rocketContainer.rotation.y;
                    while (delta > Math.PI) delta -= Math.PI * 2;
                    while (delta < -Math.PI) delta += Math.PI * 2;
                    rocketContainer.rotation.y += delta * 0.2; 
                }
                const currentHitboxPos = hitboxOffset.clone().applyQuaternion(rocketContainer.quaternion).add(rocketContainer.position);
                rocketHitbox.setFromCenterAndSize(currentHitboxPos, hitboxVisualSize);
                manualObstacles.forEach(obs => {
                    obstacleSphere.set(obs.pos, obs.radius);
                    if (rocketHitbox.intersectsSphere(obstacleSphere) && !collisionActive) {
                        impactSound.currentTime = 0; impactSound.play().catch(e => {});
                        document.body.classList.add('collision-flash');
                        setTimeout(() => document.body.classList.remove('collision-flash'), 200);
                        collisionActive = true; createExplosion(currentHitboxPos);
                        setTimeout(() => { toggleRocket(); collisionActive = false; }, 50); 
                    }
                });
                if (rocketContainer) {
                    rocketContainer.position.add(velocity);
                    if(rocketModel) {
                        let pitch = -Math.PI / 2; 
                        if (keyState['KeyQ']) pitch += Math.PI / 4; if (keyState['KeyE']) pitch -= Math.PI / 4; 
                        rocketModel.rotation.x += (pitch - rocketModel.rotation.x) * 0.1;
                    }
                }
            }
            if (introActive && targetPosition.length() > 0) {
                camera.position.lerp(targetPosition, 0.02);
                if (camera.position.distanceTo(targetPosition) < 0.1) introActive = false;
            }
            if (zoomActive) {
                camera.position.lerp(targetPosition, 0.05); controls.target.lerp(targetLookAt, 0.05);
                if (camera.position.distanceTo(targetPosition) < 0.05) zoomActive = false;
            }
            if (document.getElementById('modal-overlay').style.display === 'flex') {
                popupControls.update(); popupRenderer.render(popupScene, popupCamera);
            }
            controls.update(); renderer.render( scene, camera );
        }
        animate();
        window.addEventListener( 'resize', () => { 
            camera.aspect = window.innerWidth/window.innerHeight; camera.updateProjectionMatrix(); 
            renderer.setSize( window.innerWidth, window.innerHeight ); 
            if(document.getElementById('modal-overlay').style.display === 'flex') {
                const container = document.getElementById('modal-3d');
                popupCamera.aspect = container.clientWidth / container.clientHeight;
                popupCamera.updateProjectionMatrix();
                popupRenderer.setSize(container.clientWidth, container.clientHeight);
            }
        });
    </script>
</body>
</html>
